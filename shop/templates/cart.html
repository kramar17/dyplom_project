{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="{% static 'css/index.css' %}">
  <link rel="icon" type="image/x-icon" href="{% static 'images/icons/favicon.ico' %}">
  <title>DIETOLOGONLINE - Корзина</title>
</head>
<body>
    <!-- Включение общей навигационной панели -->
    {% include 'nav.html' %}

    <main>
        <div class="products">
            <h1>Корзина</h1>
            <!-- Список товаров в корзине -->
            {% if cart_items %}
                {% for item in cart_items %}
                    <div class="product">
                        <h2>{{ item.product.name }}</h2>
                        <p>Цена: {{ item.product.price }}</p>
                        <p>Описание: {{ item.product.description }}</p>
                        <!-- Изображение товара -->
                        {% if item.product.photo %}
                            <img src="{{ item.product.photo.url }}" alt="{{ item.product.name }}">
                        {% endif %}
                        <div class="quantity-control">
                            <!-- Форма для уменьшения количества товара -->
                            <form method="post" action="{% url 'update_cart' %}" class="quantity-form">
                                {% csrf_token %}
                                <input type="hidden" name="product_id" value="{{ item.product.id }}">
                                <button type="submit" name="decrease_quantity" class="quantity-button decrease">-</button>
                            </form>
                            <span>в корзине {{ item.quantity }} шт</span>
                            <!-- Форма для увеличения количества товара -->
                            <form method="post" action="{% url 'update_cart' %}" class="quantity-form">
                                {% csrf_token %}
                                <input type="hidden" name="product_id" value="{{ item.product.id }}">
                                <button type="submit" name="increase_quantity" class="quantity-button increase">+</button>
                            </form>
                            <!-- Форма для удаления товара из корзины -->
                            <form method="post" action="{% url 'update_cart' %}" class="quantity-form">
                                {% csrf_token %}
                                <input type="hidden" name="product_id" value="{{ item.product.id }}">
                                <button type="submit" name="remove_item" class="quantity-button remove">Удалить</button>
                            </form>
                        </div>
                    </div>
                {% endfor %}
                <!-- Общая стоимость товаров в корзине -->
                <div class="total">
                    <h3>Общая стоимость: {{ total_price }}</h3>
                </div>
                <!-- Кнопка перейти к оплате -->
                <form method="post" action="{% url 'payment' %}">
                    {% csrf_token %}
                    <button type="submit" class="pay-button">Перейти к оплате</button>
                </form>
            {% else %}
                <p>Ваша корзина пуста.</p>
            {% endif %}
        </div>
    </main>

    <footer>
        <!-- Футер, если есть -->
    </footer>

    <style>
        body {
          font-family: Arial, sans-serif;
          margin: 0 auto;
          max-width: 1200px;
          padding: 20px;
        }
        main {
          padding-left: 20px;
        }
        .products {
          padding-left: 20px;
        }
        .product {
          margin-bottom: 20px;
          padding: 10px;
          border: 1px solid #ddd;
          background-color: #f9f9f9;
        }
        .product img {
          max-width: 100px;
          max-height: 100px;
          margin-bottom: 10px;
        }
        .quantity-control {
          display: flex;
          align-items: center;
        }
        .quantity-form {
          display: inline;
          margin: 0 5px;
        }
        .quantity-button {
          font-size: 18px;
          padding: 5px 10px;
          border: none;
          cursor: pointer;
        }
        .quantity-button.decrease, .quantity-button.increase {
          background-color: green;
          color: white;
          margin: 0 5px;
        }
        .quantity-button.remove {
          background-color: red;
          color: white;
          margin-left: 10px;
        }
        .total {
          margin-top: 20px;
        }
        .pay-button {
          background-color: red;
          color: white;
          border: none;
          padding: 10px 20px;
          cursor: pointer;
          float: right;
          margin-top: 20px;
        }
    </style>
</body>
</html>
